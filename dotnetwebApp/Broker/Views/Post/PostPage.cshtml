@using Broker.ViewModels
@using Broker.Models
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
@model FilteredPostViewModel;
@{
   
        var pager = new Pagination();
    if(ViewBag.Pager != null)
    {
        pager = ViewBag.Pager;
    }
}

<link href="@Url.Content("~/css/UserPostPage.css")" rel="stylesheet" type="text/css" />



<div class="container">

    <div class="search-products">
        <form class="search-form" method='get' asp-action="PostPage">
          

            <select id="select-category" name='category'>
               <option value="">Select Category</option>
                @foreach(var cat in Model.FilteredCategories)
                {
       <option selected="@(Model.Category == @cat.CategoryName)" value="@cat.CategoryName">@cat.CategoryName</option>             
                }
            </select>

            
            <select id="select-city" name='city'>
                <option value="">Select City</option>
                @foreach(var city in @Model.Cities)
                {
                    <option selected="@(Model.City == city)" value="@city">@city</option>
                }
            </select>

             <input id="btn-submit" type='submit' value='Search' />
        </form>

    </div>
    <a href="/Archive/Index" class="btn btn-primary">Archived posts</a>

   <div class="container">
        <div class="row">
            @foreach(var post in @Model.FilteredPosts)
            {
                
            <div class="col-4">

                <article class="post-card">
                    <div class="post-card-img">
                       <img src="~/Assets//Images/grid1.jpg" />
                    </div>
                    <div class="post-card-info">
                        <div class="post-card-info-address">
                            
                            <h3>@post.Country</h3>
                            <p>@post.City</p>
                            <hr />
                            <h3>@post.Title</h3>
                            <p>@post.Description</p>
                            <hr />
                            <div class="post-price-btns">
                                <h3>$@post.Price</h3>
                                <a href="#" class="btn btn-outline-primary">View Details</a>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
            }
             </div>
              </div>

</div>


<div class="container">


    @if(pager.TotalPages > 0)
    {
        <ul class="pagination justify-content-center"> 

     @if(pager.CurrentPage > 1)
    {
        <li class="page-item ">
                    <a class="page-link" asp-controller="Post" asp-action="PostPage" asp-route-category=@Model.Category asp-route-city=@Model.City asp-route-pg="1">First</a>
                </li>
                <li class="page-item ">
                    <a class="page-link" asp-controller="Post" asp-action="PostPage" asp-route-category=@Model.Category asp-route-city=@Model.City asp-route-pg="@(pager.CurrentPage - 1)">Previous</a>
                </li>
    }

            @for (var page = pager.StartPage; page <= pager.EndPage; page++)
            {
                <li class="page-item @(page == pager.CurrentPage ? "active" : "")">
                    <a class="page-link" asp-controller="Post" asp-action="PostPage" asp-route-category=@Model.Category asp-route-city=@Model.City asp-route-pg="@(page)">@(page)</a>
                </li>
            }

                @if(pager.CurrentPage < pager.TotalPages)
    {
        <li class="page-item ">
                    <a class="page-link" asp-controller="Post" asp-action="PostPage" asp-route-category=@Model.Category asp-route-city=@Model.City asp-route-pg="@(pager.CurrentPage + 1)">Next</a>
                </li>
                <li class="page-item ">
                    <a class="page-link" asp-controller="Post" asp-action="PostPage" asp-route-category=@Model.Category asp-route-city=@Model.City asp-route-pg="@(pager.TotalPages)">Last</a>
                </li>
    }

        </ul>
    }


</div>


<script src="@Url.Content("~/js/UserPostPage.js")"></script>