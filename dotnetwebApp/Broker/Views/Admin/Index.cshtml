@model AdminAllUsersAndPosts
@{
    ViewData["Title"] = "Index";
}
<link href="@Url.Content("~/css/material-dashboard.css")" rel="stylesheet" type="text/css" />
<h1>Index</h1>

<div class="row">
    <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4" onclick="AllPosts()">
        <div class="card">
            <div class="card-header p-3 pt-2">
                <div class="icon icon-lg icon-shape bg-gradient-dark shadow-dark text-center border-radius-xl mt-n4 position-absolute">
                    <i class="material-icons opacity-10">Posts</i>
                </div>
                <div class="text-end pt-1">
                    <p class="text-sm mb-0 text-capitalize">Number of Posts</p>
                    <h4 class="mb-0">@Model.Posts.Count</h4>
                </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-3">
                <p class="mb-0"><span class="text-success text-sm font-weight-bolder">+55% </span>than last week</p>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-header p-3 pt-2">
                <div class="icon icon-lg icon-shape bg-gradient-primary shadow-primary text-center border-radius-xl mt-n4 position-absolute">
                    <i class="material-icons opacity-10">Users</i>
                </div>
                <div class="text-end pt-1">
                    <p class="text-sm mb-0 text-capitalize">Today's Users</p>
                    <h4 class="mb-0">@Model.Users.Count</h4>
                </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-3">
                <p class="mb-0"><span class="text-success text-sm font-weight-bolder">+3% </span>than last month</p>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-header p-3 pt-2">
                <div class="icon icon-lg icon-shape bg-gradient-success shadow-success text-center border-radius-xl mt-n4 position-absolute">
                    <i class="material-icons opacity-10">person</i>
                </div>
                <div class="text-end pt-1">
                    <p class="text-sm mb-0 text-capitalize">New Clients</p>
                    <h4 class="mb-0">3,462</h4>
                </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-3">
                <p class="mb-0"><span class="text-danger text-sm font-weight-bolder">-2%</span> than yesterday</p>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6">
        <div class="card">
            <div class="card-header p-3 pt-2">
                <div class="icon icon-lg icon-shape bg-gradient-info shadow-info text-center border-radius-xl mt-n4 position-absolute">
                    <i class="material-icons opacity-10">weekend</i>
                </div>
                <div class="text-end pt-1">
                    <p class="text-sm mb-0 text-capitalize">Sales</p>
                    <h4 class="mb-0">$103,430</h4>
                </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-3">
                <p class="mb-0"><span class="text-success text-sm font-weight-bolder">+5% </span>than yesterday</p>
            </div>
        </div>
    </div>
</div>
<div class="row mt-4">
    <div class="col-lg-4 col-md-6 mt-4 mb-4">
        <div class="card z-index-2 ">
            <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2 bg-transparent">
                <div class="bg-gradient-primary shadow-primary border-radius-lg py-3 pe-1">
                    <div class="chart">
                        <canvas id="chart-bars" class="chart-canvas" height="170" width="534" style="display: block; box-sizing: border-box; height: 170px; width: 100%;"></canvas>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <h6 class="mb-0 ">Website Views</h6>
                <p class="text-sm ">Last Campaign Performance</p>
                <hr class="dark horizontal">
                <div class="d-flex ">
                    <i class="material-icons text-sm my-auto me-1">schedule</i>
                    <p class="mb-0 text-sm"> campaign sent 2 days ago </p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4 col-md-6 mt-4 mb-4">
        <div class="card z-index-2  ">
            <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2 bg-transparent">
                <div class="bg-gradient-success shadow-success border-radius-lg py-3 pe-1">
                    <div class="chart">
                        <canvas id="chart-line" class="chart-canvas" height="170" width="534" style="display: block; box-sizing: border-box; height: 170px; width: 100%;"></canvas>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <h6 class="mb-0 "> Daily Sales </h6>
                <p class="text-sm "> (<span class="font-weight-bolder">+15%</span>) increase in today sales. </p>
                <hr class="dark horizontal">
                <div class="d-flex ">
                    <i class="material-icons text-sm my-auto me-1">schedule</i>
                    <p class="mb-0 text-sm"> updated 4 min ago </p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4 mt-4 mb-3">
        <div class="card z-index-2 ">
            <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2 bg-transparent">
                <div class="bg-gradient-dark shadow-dark border-radius-lg py-3 pe-1">
                    <div class="chart">
                        <canvas id="chart-line-tasks" class="chart-canvas" height="170" width="534" style="display: block; box-sizing: border-box; height: 170px; width: 100%;"></canvas>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <h6 class="mb-0 ">Completed Tasks</h6>
                <p class="text-sm ">Last Campaign Performance</p>
                <hr class="dark horizontal">
                <div class="d-flex ">
                    <i class="material-icons text-sm my-auto me-1">schedule</i>
                    <p class="mb-0 text-sm">just updated</p>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="chartContainer" style="height: 300px; width: 80%;"></div>
<div id="chart-Container" style="height: 300px; width: 80%;"></div>


<script src="@Url.Content("~/js/material-dashboard.js")"></script>

<script>
    function AllPosts() {
        window.location.href = "https://localhost:44359/Admin/AllPosts"
    }
    window.onload = function() {
        var count = @Model.SetPostCountForMonth(new DateTime(2022, 1, 1));
        console.log(count)
        var options = {
            exportEnabled: true,
            animationEnabled: true,
            title: {
                text: ""
            },
            subtitles: [{
                text: ""
            }],
            axisX: {
                title: "States"
            },
            axisY: {
                title: "Post Created",
                titleFontColor: "#4F81BC",
                lineColor: "#4F81BC",
                labelFontColor: "#4F81BC",
                tickColor: "#4F81BC"
            },
            toolTip: {
                shared: true
            },
            legend: {
                cursor: "pointer",
                itemclick: toggleDataSeries
            },
            data: [{
                type: "spline",
                name: "Post Created",
                showInLegend: true,
                yValueFormatString: "#,##0 Posts",
                dataPoints: [
                    { x: new Date(2022, 0, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 1, 1)) },
                    { x: new Date(2022, 1, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 2, 1)) },
                    { x: new Date(2022, 2, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 3, 1)) },
                    { x: new Date(2022, 3, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 4, 1)) },
                    { x: new Date(2022, 4, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 5, 1)) },
                    { x: new Date(2022, 5, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 6, 1)) },
                    { x: new Date(2022, 6, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 7, 1)) },
                    { x: new Date(2022, 6, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 8, 1)) },
                    { x: new Date(2022, 6, 1), y: @Model.SetPostCountForMonth(new DateTime(2022, 9, 1)) }
                ]
            },
           ]
        };
        $("#chartContainer").CanvasJSChart(options);

        function toggleDataSeries(e) {
            if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                e.dataSeries.visible = false;
            } else {
                e.dataSeries.visible = true;
            }
            e.chart.render();
        }


        /////////
        var options1 = {
            title: {
                text: "Number of Active Users in Website"
            },
            axisY: {
                includeZero: true
            },
            data: [{
                type: "column",
                xValueFormatString:"MMM YYYY",
                yValueFormatString: "#,##0",
                indexLabel: "{x}",
                color: "#546BC1",
                dataPoints: [
                    { label: new Date(2022, 0, 1), y: @Model.SetUserCountForMonth(new DateTime(2022, 1, 1)) },
                    { label: new Date(2022, 1, 1), y: @Model.SetUserCountForMonth(new DateTime(2022, 2, 1)) },
                    { label: new Date(2022, 2, 1), y: @Model.SetUserCountForMonth(new DateTime(2022, 3, 1)) },
                    { label: new Date(2022, 3, 1), y: @Model.SetUserCountForMonth(new DateTime(2022, 4, 1)) },
                    { label: new Date(2022, 4, 1), y: @Model.SetUserCountForMonth(new DateTime(2022, 5, 1)) },
                    { label: new Date(2022, 5, 1), y: @Model.SetUserCountForMonth(new DateTime(2022, 6, 1)) },
                    { label: new Date(2022, 6, 1), y: @Model.SetUserCountForMonth(new DateTime(2022, 7, 1)) }
                    
                ]
            }]
        };
        $("#chart-Container").CanvasJSChart(options1);

        function updateChart() {
            var performance, deltaY, yVal;
            var dps = options1.data[0].dataPoints;
            for (var i = 0; i < dps.length; i++) {
                deltaY = Math.round(2 + Math.random() * (-2 - 2));
                yVal = deltaY + dps[i].y > 0 ? dps[i].y + deltaY : 0;
                dps[i].y = yVal;
            }
            options1.data[0].dataPoints = dps;
            $("#chart-Container").CanvasJSChart().render();
        };
        //updateChart();

    };

</script>

